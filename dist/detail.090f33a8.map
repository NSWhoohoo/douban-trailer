{"version":3,"sources":["views/movie/detail.js"],"names":["moment","locale","TabPane","Tabs","DPlayer","window","site","callback","key","console","log","Detail","props","_getMovieDetail","method","url","state","_id","then","res","movie","relativeMovies","video","videoKey","pic","coverKey","setState","player","container","document","getElementById","screenshot","thumbnails","catch","history","goBack","match","params","id","title","rate","backgroundColor","tags","join","meta","createdAt","fromNow","summary","map","item","posterKey","pubdate","it","i","date","format","country","Component"],"mappings":"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","file":"detail.090f33a8.map","sourceRoot":"../src","sourcesContent":["import React, { Component } from 'react'\nimport { Link } from 'react-router-dom'\nimport { Menu, Tabs, Badge } from 'antd'\nimport request from '../../lib/request'\nimport moment from 'moment'\nimport 'moment/locale/zh-cn'\nmoment.locale('zh-cn')\n\nconst TabPane = Tabs.TabPane\nconst DPlayer = window.DPlayer\nconst site = 'http://pnlbsdu7j.bkt.clouddn.com/'\nconst callback = (key) => {\n    console.log(key)\n}\n\nexport default class Detail extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            movie: null,\n            relativeMovies: [],\n            _id: this.props.match.params.id\n        }\n    }\n\n    componentDidMount() {\n        this._getMovieDetail()\n    }\n\n    _getMovieDetail = () => {\n        request({\n          method: 'get',\n          url: `/api/v0/movies/${this.state._id}`\n        }).then(res => {\n            const movie = res.movie\n            const relativeMovies = res.relativeMovies\n            const video = site + movie.videoKey\n            const pic = site + movie.coverKey\n          this.setState({\n            movie,\n            relativeMovies\n          }, () => {\n            this.player = new DPlayer({\n                container: document.getElementById('videoPlayer'),\n                screenshot: true,\n                video: {\n                  url: video,\n                  pic: pic,\n                  thumbnails: pic\n                }\n              })\n          })\n        }).catch(() => {\n          this.setState({\n            movie: {}\n          })\n\n          this.props.history.goBack()\n        })\n      }\n\n    render() {\n        const {movie, relativeMovies} = this.state\n        if (!movie) return null\n\n        return (\n            <div className='flex-row full'>\n                <div className='page-shade'>\n                    <div className='video-wrapper'>\n                        <div id='videoPlayer' data-src={site + movie.coverKey} data-video={site + movie.videoKey} />\n                    </div>\n                    <div className='video-sidebar'>\n                        <Link className='homeLink' to={'/'}>回到首页</Link>\n                        <Tabs\n                            defaultActiveKey='1'\n                            onChange={callback}\n                        >\n                            <TabPane tab='关于本片' key='1'>\n                                <h1>{movie.title}</h1>\n                                <dl>\n                                    <dt>豆瓣评分: <Badge count={movie.rate} style={{backgroundColor: '5#c41a'}}/> 分</dt>\n                                    <dt>电影分类: {movie.tags && movie.tags.join(' ')}</dt>\n                                    <dt>更新时间: {moment(movie.meta.createdAt).fromNow()}</dt>\n                                    <dt>影片介绍: </dt>\n                                    <dd>{movie.summary}</dd>\n                                </dl>\n                            </TabPane>\n                            <TabPane tab='同类电影' key='2'>\n                                {\n                                    relativeMovies.map(item => (\n                                        <Link key={item._id} className='media' to={`/detail/${item._id}`}>\n                                            <img width='60' className='align-self-center mr-3' src={site + item.posterKey} />\n                                            <div className='media-body'>\n                                                <h6 className='media-title'>{item.title}</h6>\n                                                <ul className='list-unstyled'>\n                                                    {\n                                                        item.pubdate && item.pubdate.map((it, i) => {\n                                                            <li key={i}>{moment(it.date).format('YYYY.MM')}{it.country}</li>\n                                                        })\n                                                    }\n                                                </ul>\n                                            </div>\n                                        </Link>\n                                    ))\n                                }\n                            </TabPane>\n                        </Tabs>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n}"]}